; PlatformIO Project Configuration File
;
;   Build options: build flags, source filter
;   Upload options: custom upload port, speed and extra flags
;   Library options: dependencies, extra library storages
;   Advanced options: extra scripting
;
; Please visit documentation for the other options and examples
; https://docs.platformio.org/page/projectconf.html

[platformio]
src_dir = src
include_dir = src

default_envs = esp8266


[libraries]
ArduinoJson = bblanchon/ArduinoJson @ 6.10.0
pubsubclient = PubSubClient
esp_wifi_manager = https://github.com/khoih-prog/ESPAsync_WiFiManager.git
dnsserver = bbx10/DNSServer
modbus_master = 4-20ma/ModbusMaster
ESPUI = https://github.com/s00500/ESPUI.git#05879186211737e7aa63005377b9d7a69865ac6d
ESPAsyncWebServer = https://github.com/me-no-dev/ESPAsyncWebServer.git
ESPAsyncTCP = https://github.com/me-no-dev/ESPAsyncTCP.git

[env:esp8266]
framework = arduino
platform = espressif8266@2.6.3
board = d1_mini
board_build.flash_mode = qio
upload_port = COM7
monitor_speed = 115200
lib_deps =
  ${libraries.pubsubclient}
  ${libraries.esp_wifi_manager}
  ${libraries.dnsserver}
  ${libraries.modbus_master}
  ${libraries.ESPUI}
  ${libraries.ArduinoJson}
  ${libraries.ESPAsyncWebServer}
  ${libraries.ESPAsyncTCP}
build_flags = 
  '-DDEFAULT_MQTT_SERVER="192.168.5.2"'
  '-DDEFAULT_MQTT_USERNAME="light_switches"'
  '-DDEFAULT_MQTT_PASSWORD="lettherebelight"'
  '-DDEFAULT_MQTT_TOPIC="epever"'
;  '-DDEFAULT_MQTT_PORT=1883'
  '-DDEFAULT_INFLUXDB_HOST="192.168.5.2"'
  '-DDEFAULT_INFLUXDB_DATABASE="powerwall"'
  '-DDEFAULT_INFLUXDB_USER="epever2"'
  '-DDEFAULT_INFLUXDB_PASSWORD="mppt_powerwall"'
;  '-DDEFAULT_INFLUXDB_PORT=8086'
;  '-DDEFAULT_DEVICE_ID=1'
;  '-DDEFAULT_SERIAL_BAUD=115200'
  '-DMQTT_MAX_PACKET_SIZE=512'
  '-DHADISCOVERY=1'